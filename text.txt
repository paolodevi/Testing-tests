% Read the entire file into a cell array
fid = fopen(seqFile, 'r');
fileLines = {};
while ~feof(fid)
    fileLines{end+1,1} = fgetl(fid); %#ok<SAGROW>
end
fclose(fid);

% Safety check
if isnan(lineID) || lineID > numel(fileLines)
    error('Invalid lineID. Cannot insert text.');
end

% Insert new text AFTER the separator line
fileLines = [
    fileLines(1:lineID)
    newText(:)
    fileLines(lineID+1:end)
];

% Write the modified content back to file
fid = fopen(seqFile, 'w');
if fid == -1
    error('Could not open "%s" for writing.', seqFile);
end

for i = 1:numel(fileLines)
    fprintf(fid, '%s\n', fileLines{i});
end

fclose(fid);