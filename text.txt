% Number of match stages
M = numel(matches);

% Initial values: row 1 of reference
current = matches{1}(1, :);

% Loop through each matching stage
for i = 1:M
    src = matches{i}(1, :);
    dst = matches{i}(2, :);

    % Map current values through this stage
    [tf, idx] = ismember(current, src);

    if ~all(tf)
        error('Some values could not be matched at stage %d', i);
    end

    current = dst(idx);
end

% Final result
result = [matches{1}(1, :);
          current];