function recolor_lines(targetColor, cmapName)
% RECOLOR_LINES   Cambia il colore delle linee con un certo colore in una colormap.
%
%   recolor_lines(targetColor, cmapName)
%
%   targetColor : colore da sostituire (es. [0 0 1] per blu)
%   cmapName    : stringa colormap (es. 'jet', 'parula', 'hsv', ecc.)
%
%   Esempio:
%       plot(rand(10,1), 'b'); hold on;
%       plot(rand(10,1), 'b');
%       plot(rand(10,1), 'Color', [0.5 0 0.5]); % viola, resta invariata
%       recolor_lines([0 0 1], 'jet');

    if nargin < 2
        cmapName = 'jet'; % default
    end

    % Trova tutte le linee nell'axes corrente
    h = findall(gca, 'Type', 'Line');

    % Filtra quelle col colore target
    mask = arrayfun(@(x) isequal(get(x,'Color'), targetColor), h);
    h_sel = h(mask);

    % Se non ce ne sono, esci
    if isempty(h_sel)
        warning('Nessuna linea trovata con il colore specificato.');
        return;
    end

    % Applica la colormap
    n = numel(h_sel);
    cmap = feval(cmapName, n);

    % MATLAB restituisce gli handle in ordine inverso -> flipud
    h_sel = flipud(h_sel);

    for i = 1:n
        set(h_sel(i), 'Color', cmap(i,:));
    end
end